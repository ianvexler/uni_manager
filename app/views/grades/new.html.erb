<h1>Your Grades:</h1>

<% @mods = Mod.where(username: Current.user.username) %>
<% if @mods.any? %>
    <% @mods.all.each do |mod| %>
        <div class="mod_table">
        <ul>
            <li><p>Code: <%= mod[:code] %></p></li>
            <li><p>Name: <%= mod[:module_name] %></p></li>
            <li><p>Year: <%= mod[:year] %></p></li>
            
            <li>
                <% @grades = Grade.where(username: Current.user.username, code: mod[:code]) %>
                <% if @grades.any? %>
                    <% @grades.all.each do |grade| %>
                        <ul>
                            <li><p>Name: <%= grade[:grade_name] %></p></li>
                            <li><p>Percentage: <%= grade[:grade_percentage] %></p></li>
                        </ul>
                    <% end %>
                <% else %>
                    <p>You have no grades for this module</p>
                <% end %>
            </li>
            
        </ul>
        <%= render partial: "shared/add_grades", locals: {code: mod[:code]} %>

        </div>
    <% end %>
<% else %>
    <p>You have no modules</p>
<% end %>

<%= render partial: "shared/add_modules" %>